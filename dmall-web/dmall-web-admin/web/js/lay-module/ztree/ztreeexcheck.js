"use strict";layui.define(function(e){function t(){var e={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},t={check:{enable:!1,autoCheckTrigger:!1,chkStyle:e.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:e.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},h=function(e){T.getRoot(e).radioCheckedList=[]},a=function(e){},n=function(e){var t=e.treeObj,c=v.event;t.bind(c.CHECK,function(t,c,h,a){t.srcEvent=c,p.apply(e.callback.onCheck,[t,h,a])})},i=function(e){var t=e.treeObj,c=v.event;t.unbind(c.CHECK)},r=function(e){var t=e.target,c=T.getSetting(e.data.treeId),h="",a=null,n="",i=null;if(p.eqs(e.type,"mouseover")?c.check.enable&&p.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+v.id.CHECK)&&(h=p.getNodeMainDom(t).id,n="mouseoverCheck"):p.eqs(e.type,"mouseout")?c.check.enable&&p.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+v.id.CHECK)&&(h=p.getNodeMainDom(t).id,n="mouseoutCheck"):p.eqs(e.type,"click")&&c.check.enable&&p.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+v.id.CHECK)&&(h=p.getNodeMainDom(t).id,n="checkNode"),h.length>0)switch(a=T.getNodeCache(c,h),n){case"checkNode":i=C.onCheckNode;break;case"mouseoverCheck":i=C.onMouseoverCheck;break;case"mouseoutCheck":i=C.onMouseoutCheck}return{stop:"checkNode"===n,node:a,nodeEventType:n,nodeEventCallback:i,treeEventType:"",treeEventCallback:null}},d=function(e,t,c,h,a,n,i){if(c){var r=T.nodeChecked(e,c);if(r=T.nodeChecked(e,c,r),c.checkedOld=r,"string"==typeof c.nocheck&&(c.nocheck=p.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||e.check.nocheckInherit&&h&&!!h.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=p.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||e.check.chkDisabledInherit&&h&&!!h.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=p.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return T.getCheckStatus(e,c)},e.check.chkStyle==v.radio.STYLE&&e.check.radioType==v.radio.TYPE_ALL&&r){T.getRoot(e).radioCheckedList.push(c)}}},o=function(e,t,c){e.check.enable&&(T.makeChkFlag(e,t),c.push("<span ID='",t.tId,v.id.CHECK,"' class='",S.makeChkClass(e,t),"' treeNode",v.id.CHECK,!0===t.nocheck?" style='display:none;'":"","></span>"))},k=function(e,t){t.checkNode=function(t,c,h,a){var n=T.nodeChecked(e,t);if(!0!==t.chkDisabled&&(!0!==c&&!1!==c&&(c=!n),a=!!a,(n!==c||h)&&(!a||0!=p.apply(this.setting.callback.beforeCheck,[this.setting.treeId,t],!0))&&p.uCanDo(this.setting)&&this.setting.check.enable&&!0!==t.nocheck)){T.nodeChecked(e,t,c);var i=N(t,v.id.CHECK,this.setting);(h||this.setting.check.chkStyle===v.radio.STYLE)&&S.checkNodeRelation(this.setting,t),S.setChkClass(this.setting,i,t),S.repairParentChkClassWithSelf(this.setting,t),a&&this.setting.treeObj.trigger(v.event.CHECK,[null,this.setting.treeId,t])}},t.checkAllNodes=function(e){S.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(t){var t=!1!==t,c=T.nodeChildren(e,T.getRoot(this.setting));return T.getTreeCheckedNodes(this.setting,c,t)},t.getChangeCheckedNodes=function(){var t=T.nodeChildren(e,T.getRoot(this.setting));return T.getTreeChangeCheckedNodes(this.setting,t)},t.setChkDisabled=function(e,t,c,h){t=!!t,c=!!c,h=!!h,S.repairSonChkDisabled(this.setting,e,t,h),S.repairParentChkDisabled(this.setting,e.getParentNode(),t,c)};var c=t.updateNode;t.updateNode=function(e,h){if(c&&c.apply(t,arguments),e&&this.setting.check.enable){if(N(e,this.setting).get(0)&&p.uCanDo(this.setting)){var a=N(e,v.id.CHECK,this.setting);1!=h&&this.setting.check.chkStyle!==v.radio.STYLE||S.checkNodeRelation(this.setting,e),S.setChkClass(this.setting,a,e),S.repairParentChkClassWithSelf(this.setting,e)}}}},s={getRadioCheckedList:function(e){for(var t=T.getRoot(e).radioCheckedList,c=0,h=t.length;c<h;c++)T.getNodeCache(e,t[c].tId)||(t.splice(c,1),c--,h--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var c=T.nodeChecked(e,t);return{checked:c,half:t.halfCheck?t.halfCheck:e.check.chkStyle==v.radio.STYLE?2===t.check_Child_State:c?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,c,h){if(!t)return[];var a=c&&e.check.chkStyle==v.radio.STYLE&&e.check.radioType==v.radio.TYPE_ALL;h=h||[];for(var n=0,i=t.length;n<i;n++){var r=t[n],d=T.nodeChildren(e,r),o=T.nodeChecked(e,r);if(!0!==r.nocheck&&!0!==r.chkDisabled&&o==c&&(h.push(r),a))break;if(T.getTreeCheckedNodes(e,d,c,h),a&&h.length>0)break}return h},getTreeChangeCheckedNodes:function(e,t,c){if(!t)return[];c=c||[];for(var h=0,a=t.length;h<a;h++){var n=t[h],i=T.nodeChildren(e,n),r=T.nodeChecked(e,n);!0!==n.nocheck&&!0!==n.chkDisabled&&r!=n.checkedOld&&c.push(n),T.getTreeChangeCheckedNodes(e,i,c)}return c},makeChkFlag:function(e,t){if(t){var c=-1,h=T.nodeChildren(e,t);if(h)for(var a=0,n=h.length;a<n;a++){var i=h[a],r=T.nodeChecked(e,i),d=-1;if(e.check.chkStyle==v.radio.STYLE){if(2==(d=!0===i.nocheck||!0===i.chkDisabled?i.check_Child_State:!0===i.halfCheck?2:r?2:i.check_Child_State>0?2:0)){c=2;break}0==d&&(c=0)}else if(e.check.chkStyle==v.checkbox.STYLE){if(1===(d=!0===i.nocheck||!0===i.chkDisabled?i.check_Child_State:!0===i.halfCheck?1:r?-1===i.check_Child_State||2===i.check_Child_State?2:1:i.check_Child_State>0?1:0)){c=1;break}if(2===d&&c>-1&&a>0&&d!==c){c=1;break}if(2===c&&d>-1&&d<2){c=1;break}d>-1&&(c=d)}}t.check_Child_State=c}}},l={},C={onCheckNode:function(e,t){if(!0===t.chkDisabled)return!1;var c=T.getSetting(e.data.treeId);if(0==p.apply(c.callback.beforeCheck,[c.treeId,t],!0))return!0;var h=T.nodeChecked(c,t);T.nodeChecked(c,t,!h),S.checkNodeRelation(c,t);var a=N(t,v.id.CHECK,c);return S.setChkClass(c,a,t),S.repairParentChkClassWithSelf(c,t),c.treeObj.trigger(v.event.CHECK,[e,c.treeId,t]),!0},onMouseoverCheck:function(e,t){if(!0===t.chkDisabled)return!1;var c=T.getSetting(e.data.treeId),h=N(t,v.id.CHECK,c);return t.check_Focus=!0,S.setChkClass(c,h,t),!0},onMouseoutCheck:function(e,t){if(!0===t.chkDisabled)return!1;var c=T.getSetting(e.data.treeId),h=N(t,v.id.CHECK,c);return t.check_Focus=!1,S.setChkClass(c,h,t),!0}},f={},u={checkNodeRelation:function(e,t){var c,h,a,n=v.radio,i=T.nodeChecked(e,t);if(e.check.chkStyle==n.STYLE){var r=T.getRadioCheckedList(e);if(i)if(e.check.radioType==n.TYPE_ALL){for(h=r.length-1;h>=0;h--){c=r[h];var d=T.nodeChecked(e,c);d&&c!=t&&(T.nodeChecked(e,c,!1),r.splice(h,1),S.setChkClass(e,N(c,v.id.CHECK,e),c),c.parentTId!=t.parentTId&&S.repairParentChkClassWithSelf(e,c))}r.push(t)}else{var o=t.parentTId?t.getParentNode():T.getRoot(e),k=T.nodeChildren(e,o);for(h=0,a=k.length;h<a;h++){c=k[h];var d=T.nodeChecked(e,c);d&&c!=t&&(T.nodeChecked(e,c,!1),S.setChkClass(e,N(c,v.id.CHECK,e),c))}}else if(e.check.radioType==n.TYPE_ALL)for(h=0,a=r.length;h<a;h++)if(t==r[h]){r.splice(h,1);break}}else{var k=T.nodeChildren(e,t);i&&(!k||0==k.length||e.check.chkboxType.Y.indexOf("s")>-1)&&S.setSonNodeCheckBox(e,t,!0),i||k&&0!=k.length&&!(e.check.chkboxType.N.indexOf("s")>-1)||S.setSonNodeCheckBox(e,t,!1),i&&e.check.chkboxType.Y.indexOf("p")>-1&&S.setParentNodeCheckBox(e,t,!0),!i&&e.check.chkboxType.N.indexOf("p")>-1&&S.setParentNodeCheckBox(e,t,!1)}},makeChkClass:function(e,t){var c=v.checkbox,h=v.radio,a="",n=T.nodeChecked(e,t);a=!0===t.chkDisabled?c.DISABLED:t.halfCheck?c.PART:e.check.chkStyle==h.STYLE?t.check_Child_State<1?c.FULL:c.PART:n?2===t.check_Child_State||-1===t.check_Child_State?c.FULL:c.PART:t.check_Child_State<1?c.FULL:c.PART;var i=e.check.chkStyle+"_"+(n?c.TRUE:c.FALSE)+"_"+a;return i=t.check_Focus&&!0!==t.chkDisabled?i+"_"+c.FOCUS:i,v.className.BUTTON+" "+c.DEFAULT+" "+i},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===v.checkbox.STYLE)for(var c=T.getRoot(e),h=T.nodeChildren(e,c),a=0,n=h.length;a<n;a++){var i=h[a];!0!==i.nocheck&&!0!==i.chkDisabled&&T.nodeChecked(e,i,t),S.setSonNodeCheckBox(e,i,t)}},repairChkClass:function(e,t){if(t&&(T.makeChkFlag(e,t),!0!==t.nocheck)){var c=N(t,v.id.CHECK,e);S.setChkClass(e,c,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var c=t.getParentNode();S.repairChkClass(e,c),S.repairParentChkClass(e,c)}},repairParentChkClassWithSelf:function(e,t){if(t){var c=T.nodeChildren(e,t);c&&c.length>0?S.repairParentChkClass(e,c[0]):S.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,c,h){if(t){t.chkDisabled!=c&&(t.chkDisabled=c),S.repairChkClass(e,t);var a=T.nodeChildren(e,t);if(a&&h)for(var n=0,i=a.length;n<i;n++){var r=a[n];S.repairSonChkDisabled(e,r,c,h)}}},repairParentChkDisabled:function(e,t,c,h){t&&(t.chkDisabled!=c&&h&&(t.chkDisabled=c),S.repairChkClass(e,t),S.repairParentChkDisabled(e,t.getParentNode(),c,h))},setChkClass:function(e,t,c){t&&(!0===c.nocheck?t.hide():t.show(),t.attr("class",S.makeChkClass(e,c)))},setParentNodeCheckBox:function(e,t,c,h){var a=N(t,v.id.CHECK,e);if(h||(h=t),T.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled&&(T.nodeChecked(e,t,c),S.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=h&&e.treeObj.trigger(v.event.CHECK,[null,e.treeId,t])),t.parentTId){var n=!0;if(!c)for(var i=T.nodeChildren(e,t.getParentNode()),r=0,d=i.length;r<d;r++){var o=i[r],k=T.nodeChecked(e,o);if(!0!==o.nocheck&&!0!==o.chkDisabled&&k||(!0===o.nocheck||!0===o.chkDisabled)&&o.check_Child_State>0){n=!1;break}}n&&S.setParentNodeCheckBox(e,t.getParentNode(),c,h)}},setSonNodeCheckBox:function(e,t,c,h){if(t){var a=N(t,v.id.CHECK,e);h||(h=t);var n=!1,i=T.nodeChildren(e,t);if(i)for(var r=0,d=i.length;r<d;r++){var o=i[r];S.setSonNodeCheckBox(e,o,c,h),!0===o.chkDisabled&&(n=!0)}t!=T.getRoot(e)&&!0!==t.chkDisabled&&(n&&!0!==t.nocheck&&T.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled?(T.nodeChecked(e,t,c),n||(t.check_Child_State=i&&i.length>0?c?2:0:-1)):t.check_Child_State=-1,S.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=h&&!0!==t.nocheck&&!0!==t.chkDisabled&&e.treeObj.trigger(v.event.CHECK,[null,e.treeId,t]))}}},g={tools:f,view:u,event:l,data:s};c.extend(!0,c.fn.zTree.consts,e),c.extend(!0,c.fn.zTree._z,g);var b=c.fn.zTree,p=b._z.tools,v=b.consts,S=b._z.view,T=b._z.data,N=(b._z.event,p.$);T.nodeChecked=function(e,t,c){if(!t)return!1;var h=e.data.key.checked;return void 0!==c&&("string"==typeof c&&(c=p.eqs(c,"true")),c=!!c,t[h]=c),t[h]},T.exSetting(t),T.addInitBind(n),T.addInitUnBind(i),T.addInitCache(a),T.addInitNode(d),T.addInitProxy(r,!0),T.addInitRoot(h),T.addBeforeA(o),T.addZTreeTools(k);var E=S.createNodes;S.createNodes=function(e,t,c,h,a){E&&E.apply(S,arguments),c&&S.repairParentChkClassWithSelf(e,h)};var _=S.removeNode;S.removeNode=function(e,t){var c=t.getParentNode();_&&_.apply(S,arguments),t&&c&&(S.repairChkClass(e,c),S.repairParentChkClass(e,c))};var D=S.appendNodes;S.appendNodes=function(e,t,c,h,a,n,i){var r="";return D&&(r=D.apply(S,arguments)),h&&T.makeChkFlag(e,h),r}}var c=layui.$;e("ztreeexcheck",new t)});